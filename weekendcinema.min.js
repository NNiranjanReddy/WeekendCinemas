function AdminCtrl($scope,$rootScope,constants,StringUtil,RestAPI){var scope=$scope;scope.media={},scope.media.video=[],scope.media.img=[],scope.createId=function(name){return name?StringUtil.generateId(name):name},scope.submitPost=function(form){form.media=scope.media,form._id=scope.createId(scope.name);var jsonData=angular.toJson(form),url=constants.endpoints.post+form._id;RestAPI.post(url,jsonData).success(function(response){scope.postSuccess=response}).error(function(){console.log("error")})},scope.addPostMedia=function(media){-1!=$rootScope.postVideoType.indexOf(scope.post.type)&&-1==scope.media.video.indexOf(media)?scope.media.video.push(media):-1==scope.media.img.indexOf(media)&&scope.media.img.push(media)}}function CalendarHomeCtrl($rootScope,$scope,RestAPI,$compile,uiCalendarConfig,DateUtil){$scope.eventRender=function(event,element,view){element.attr({tooltip:event.title,"tooltip-append-to-body":!0}),$compile(element)($scope)},$scope.uiConfig={calendar:{height:450,editable:!0,header:{right:"today,prev,next",left:"",center:"title"},eventRender:$scope.eventRender}},$scope.events={events:[{title:"Bahubali 2 official trailer",start:DateUtil.toYYYY_MM_DD(new Date("2017-03-16")),url:"/cinema/Baahubali2",className:"fa fa-music color-VIDEO"},{title:"Om Namo venkatesaya",start:DateUtil.toYYYY_MM_DD(new Date("2017-02-10")),url:"/post/tikka-teaser-1",className:"fa fa-film color-mediumseagreen"},{title:"Singam 3",start:DateUtil.toYYYY_MM_DD(new Date("2017-02-09")),url:"/post/tikka-teaser-1"},{title:"Ghazi",start:DateUtil.toYYYY_MM_DD(new Date("2017-02-17")),url:"/post/tikka-teaser-1"},{title:"Raarandoi Veduka Choodham",start:DateUtil.toYYYY_MM_DD(new Date("2017-08-18")),url:"/cinema/",className:"fa fa-music color-MUSIC"},{title:"Katamarayudu teaser",start:DateUtil.toYYYY_MM_DD(new Date("2017-02-04")),url:"https://www.youtube.com/watch?v=XpAaOER_6iY",className:"fa fa-video-camera color-NEWS"},{title:"Sample Video",start:DateUtil.toYYYY_MM_DD(new Date("2017-08-18")),url:"/cinema/",className:"fa fa-video-camera color-VIDEO"},{title:"Vijay Devarakonda",start:DateUtil.toYYYY_MM_DD(new Date("2017-08-08")),url:"/celebrity",className:"fa fa-birthday-cake color-BIRTHDAY"},{title:"Sample",start:DateUtil.toYYYY_MM_DD(new Date("2017-08-18")),url:"/celebrity",className:"fa fa-birthday-cake color-BIRTHDAY"},{title:"Sample cinema",start:DateUtil.toYYYY_MM_DD(new Date("2017-08-18")),url:"/post/tikka-teaser-1",className:"fa fa-film color-mediumseagreen"}]},$scope.addCinemas=function(upcomingCinemas){var event={};upcomingCinemas.forEach(function(cinema){cinema.general.releaseDt&&(event.title=cinema.name,event.start=new Date(cinema.general.releaseDt),event.url="/cinema/"+cinema.cinemaId,event.className="fa fa-film color-mediumseagreen",$scope.events.events.push(event))})},$rootScope.upcomingCinemas?$scope.addCinemas($rootScope.upcomingCinemas):RestAPI.get(constants.api.url+"/upcomingCinemas").success(function(response){$scope.addCinemas(response.data?response.data:[])}),$scope.eventSources=[$scope.events]}function CelebrityCtrl($scope){$scope.message="Welcome to Celebrity page"}function CelebrityHomeCtrl($scope,$http){}function CinemaCtrl($scope,$http,$stateParams,RestAPI,constants){me=$scope,me.cinemaName=$stateParams.cinemaName,me.isLoading=!0,me.found=!0,me.setCurrentSong=function(val){me.currentSong=val},RestAPI.get(constants.endpoints.loadCinema+me.cinemaName).success(function(response){me.cinema=response||null,me.cinema.songs&&(me.cinema.songs.youtubeUrl?me.currentSong=me.cinema.songs.youtubeUrl:me.cinema.songs.list.length&&(me.currentSong=me.cinema.songs.list[0].youtubeUrl)),me.director=me.cinema.people.crew.find(function(cel){return"Director"===cel.type}),me.producer=me.cinema.people.crew.find(function(cel){return"Producer"===cel.type}),me.people=me.cinema.people.cast.concat(me.cinema.people.crew),me.isLoading=!1}).error(function(){me.cinema=null,me.isLoading=!1})}function CinemaHomeCtrl($scope,$http,$state,RestAPI,constants){var me=$scope;me.searchList=[],RestAPI.get(constants.endpoints.upcomingCinema).success(function(response){me.upcomingCinemas=response.data?response.data:[]}).error(function(){me.upcomingCinemas=[]}),me.searchCinema=function(){RestAPI.get(constants.endpoints.searchCinema+me.searchKey).success(function(response){me.searchList=response}).error(function(){me.searchList.push(me.searchKey)})},me.filterNull=function(value,index,array){return!0}}function BodyDirective(){return{restrict:"E",templateUrl:"app/components/common/body/Body.html"}}function And($sce){return{restrict:"E",scope:{list:"="},replace:!0,link:function(scope,elm){scope.$watch("list",function(newList){if(newList)if(newList.length>=2){var copy=angular.copy(newList),lastElm=copy.pop();if(angular.isObject(lastElm)){var copyName=[];copy.forEach(function(element){copyName.push(element.name)},this),elm.text(copyName.join().concat(" and ").concat(lastElm.name))}else elm.text(copy.join().concat(" and ").concat(lastElm))}else newList&&angular.isObject(newList[0])?elm.text(newList[0].name):elm.text(newList.join())})}}}function DateTime(){return{restrict:"E",scope:{date:"=date",format:"=format"},replace:!0,link:function(scope,elm){function formatDate(elm,date,format){if(!format&&!date)switch(format){case"YYYY":elm.text(date.getFullYear())}}scope.$watch("date",function(newVal){if(newVal){var time=new Date(newVal);formatDate(elm,time,scope.format)}}),scope.$watch("format",function(newVal){if(newVal){var format=newVal;formatDate(elm,scope.time,format)}})}}}function TimeDiff($sce){return{restrict:"E",scope:{date:"="},templateUrl:"",replace:!0,link:function(scope,elm){scope.$watch("date",function(newVal){if(newVal){var startDate=new Date,endDate=new Date(newVal),diffMs=startDate.getTime()-endDate.getTime(),diffMonths=(Math.abs(Math.round(diffMs/86400/365.25)),function(d1,d2){var months;return months=12*(d2.getFullYear()-d1.getFullYear()),months-=d1.getMonth()+1,(months+=d2.getMonth())<=0?0:months}(endDate,startDate)),diffDays=Math.floor(diffMs/864e5),diffHrs=Math.floor(diffMs%864e5/36e5),diffMins=Math.round(diffMs%864e5%36e5/6e4);diffMonths>0?elm.text(diffMonths+" months"):diffDays>0?elm.text(diffDays+" days"):diffHrs>0?elm.text(diffHrs+" hours"):diffMins>0?elm.text(diffMins+" min"):elm.text(diffMs/1e3+" sec")}})}}}function TwitterDirective($sce){return{restrict:"A",templateUrl:"app/components/common/directives/twitter/Twitter_directive.html",link:{post:function(scope,ele,attr){console.log(attr)}}}}function YoutubeDirective($sce){return{restrict:"E",replace:!0,scope:{code:"=",options:"="},replace:!0,templateUrl:"app/components/common/directives/youtube/Youtube.html",link:function(scope){scope.$watch("code",function(newVal){newVal&&(scope.url=$sce.trustAsResourceUrl("https://www.youtube.com/embed/"+newVal))})}}}function HeaderCtrl($scope,$rootScope,$location,$state,$stateParams){}function RestAPI($http){return new function(){this.get=function(url){return $http({method:"GET",url:url})},this.post=function(url,jsonData){return $http({method:"POST",url:url,data:jsonData,headers:{"Content-Type":"application/json"}})}}}function HomeCtrl($scope,$rootScope,RestAPI,$window,constants,$interval){var me=$scope;me.posts=[],me.videos=[],me.news=[],me.isLoading=!0,me.loaderTotalCount=3,me.loaderCount=0;var GET=RestAPI.get(constants.api.url+"/posts");GET.success(function(response){me.posts=response||[],me.posts.forEach(function(post,index,array){-1!=constants.postVideoType.indexOf(post.type)?me.videos.push(post):-1!=["News"].indexOf(post.type)&&me.news.push(post)}),me.showOrHideLoader()}),GET.error(function(){me.posts=[]}),(GET=RestAPI.get(constants.api.url+"/upcomingCinemas")).success(function(response){me.upcomingCinemas=response.data?response.data:[],$rootScope.upcomingCinemas=me.upcomingCinemas,me.showOrHideLoader()}),GET.error(function(){me.upcomingCinemas=[]}),(GET=RestAPI.get(constants.api.url+"/recentCinemas")).success(function(response){me.recentCinemas=response.data?response.data:[],me.showOrHideLoader()}),GET.error(function(){me.recentCinemas=[]}),me.showOrHideLoader=function(){me.loaderCount++,me.loaderTotalCount==me.loaderCount&&(me.isLoading=!1)}}function JukeBoxCtrl($scope,$http,$stateParams,constants,RestAPI,$window){var me=$scope;RestAPI.get(constants.endpoints.jukeBox).success(function(response){me.jukeBox=response}).error(function(){me.jukeBox=null}),$window.scrollTo(0,0)}function PostCtrl($scope,$http,$stateParams,constants,$window){if($scope.found=!0,$scope.isLoading=!0,$scope.$parent.posts&&$scope.$parent.posts.length>0)$scope.$parent.posts.forEach(function(item,index){item._id===$stateParams.postName&&($scope.article=item,$scope.isLoading=!1)});else{var GET=$http({method:"GET",url:constants.api.url+"/post/"+$stateParams.postName});GET.success(function(response){$scope.article=response||null,$scope.found=!0,$scope.isLoading=!1}),GET.error(function(){$scope.article=null,$scope.found=!1,$scope.isLoading=!1})}$window.scrollTo(0,0)}function PrivacyCtrl($scope,$http){}function ShortFilmCtrl($scope,$http,$stateParams,constants,$window){if($scope.found=!0,$scope.isLoading=!0,$scope.$parent.posts&&$scope.$parent.posts.length>0)$scope.$parent.posts.forEach(function(item,index){item._id===$stateParams.postName&&($scope.article=item,$scope.isLoading=!1)});else{var GET=$http({method:"GET",url:constants.api.url+"/post/"+$stateParams.postName});GET.success(function(response){$scope.article=response||null,$scope.found=!0,$scope.isLoading=!1}),GET.error(function(){$scope.article=null,$scope.found=!1,$scope.isLoading=!1})}$window.scrollTo(0,0)}function TermsCtrl($scope,$http){}var app=angular.module("WcApp",["ui.router","ui.calendar","ngMaterial"]);app.config(function($stateProvider,$urlRouterProvider,$locationProvider,$mdThemingProvider){$stateProvider.state("home",{url:"/",templateUrl:"app/components/home/Home.html",controller:"HomeCtrl"}).state("post",{url:"/post/:postName",templateUrl:"app/components/post/Post.html",controller:"PostCtrl"}).state("jukebox",{url:"/jukebox",templateUrl:"app/components/jukebox/JukeBox.html",controller:"JukeBoxCtrl"}).state("shortfilms",{url:"/shortfilms",templateUrl:"app/components/shortfilms/ShortFilm.html",controller:"ShortFilmCtrl"}).state("cinemas",{url:"/cinemas",templateUrl:"app/components/cinema/CinemaHome.html",controller:"CinemaHomeCtrl"}).state("cinema",{url:"/cinema/:cinemaName",templateUrl:"app/components/cinema/Cinema.html",controller:"CinemaCtrl"}).state("celebrities",{url:"/celebrities",templateUrl:"app/components/celebrity/CelebrityHome.html",controller:"CelebrityHomeCtrl"}).state("celebrity",{url:"/celebrity/:celebrityName",templateUrl:"app/components/celebrity/Celebrity.html",controller:"CelebrityCtrl"}).state("calendar",{url:"/calendar",templateUrl:"app/components/calendar/CalendarHome.html",controller:"CalendarHomeCtrl"}).state("privacy",{url:"/privacy",templateUrl:"app/components/privacy/privacy.html",controller:"PrivacyCtrl"}).state("terms",{url:"/terms",templateUrl:"app/components/terms/Terms.html",controller:"TermsCtrl"}).state("admin",{url:"/admin",templateUrl:"app/components/admin/Admin.html",controller:"AdminCtrl"}),$urlRouterProvider.otherwise("/"),$locationProvider.html5Mode(!0),$mdThemingProvider.theme("default").primaryPalette("green").accentPalette("pink")}),app.run(["$rootScope","$state","$stateParams","constants",function($rootScope,$state,$stateParams,constants){$rootScope.$state=$state,$rootScope.$stateParams=$stateParams,$rootScope.postVideoType=constants.postVideoType,$rootScope.postType=angular.copy($rootScope.postVideoType),$rootScope.postType.push("News"),$rootScope.date=new Date}]),app.constant("constants",{api:{url:"/v1"},endpoints:{loadCinema:"/v1/cinema/",searchCinema:"/v1/searchCinema/",upcomingCinema:"/v1/upcomingCinemas",jukeBox:"/v1/jukeBox",post:"/v1/post/"},postVideoType:["Teaser","Trailer","Stumper","Prelude","Promo Song"]}),app.controller("AdminCtrl",["$scope","$rootScope","constants","StringUtil","RestAPI",AdminCtrl]),app.controller("CalendarHomeCtrl",["$rootScope","$scope","RestAPI","$compile","uiCalendarConfig","DateUtil",CalendarHomeCtrl]),app.controller("CelebrityCtrl",["$scope",CelebrityCtrl]),app.controller("CelebrityHomeCtrl",["$scope","$http",CelebrityHomeCtrl]),app.controller("CinemaCtrl",["$scope","$http","$stateParams","RestAPI","constants",CinemaCtrl]),app.controller("CinemaHomeCtrl",["$scope","$http","$state","RestAPI","constants",CinemaHomeCtrl]),app.directive("home",[BodyDirective]),app.directive("and",["$sce",And]),app.directive("owlCarousel",function(){return{restrict:"E",transclude:!1,link:function(scope){scope.initCarousel=function(element){var defaultOptions={autoplay:!0,autoplayTimeout:2e3,rewind:!0,dots:!0,nav:!0,responsive:{0:{items:2},300:{items:3},400:{items:4},1e3:{items:10}}},customOptions=scope.$eval($(element).attr("data-options"));for(var key in customOptions)defaultOptions[key]=customOptions[key];$(element).owlCarousel(defaultOptions)}}}}).directive("owlCarouselItem",[function(){return{restrict:"E",transclude:!1,link:function(scope,element){scope.$last&&scope.initCarousel(element.parent())}}}]),app.directive("spinner",[function(){return{restrict:"E",scope:{show:"="},templateUrl:"app/components/common/directives/spinner/Spinner.html",link:function(scope,element){}}}]),app.directive("myCurrentTime",["$interval",function($interval){return function(scope,element,attrs){var stopTime;stopTime=$interval(function(){element.text(new Date)},1e3),element.on("$destroy",function(){$interval.cancel(stopTime)})}}]),app.directive("dateTime",["$sce",DateTime]),app.directive("timeDiff",["$sce",TimeDiff]),app.directive("twitter",["$sce",TwitterDirective]),app.directive("myYoutube",["$sce",YoutubeDirective]),app.filter("emptyFilter",[function(){var deep_value=function(obj,path){for(var i=0,len=(path=path.split(".")).length;i<len;i++)obj=obj[path[i]];return obj};return function(items,path,flag){var filtered=[];return flag=!flag,items&&items.forEach(function(element){(flag?deep_value(element,path):!deep_value(element,path))&&filtered.push(element)}),filtered}}]),app.controller("MenuCtrl",["$scope","$rootScope","$location","$state","$stateParams",HeaderCtrl]),app.service("DateUtil",[function(){return new function(){this.toYYYY_MM_DD=function(date){return date.toISOString().split("T")[0]}}}]),app.service("RestAPI",["$http",RestAPI]),app.constant("Endpoints",{}),app.service("StringUtil",[function(){return new function(){this.generateId=function(str){return angular.lowercase(str.split(" ").join("-"))}}}]),app.controller("HomeCtrl",["$scope","$rootScope","RestAPI","$window","constants",HomeCtrl]),app.controller("JukeBoxCtrl",["$scope","$http","$stateParams","constants","RestAPI","$window",JukeBoxCtrl]),app.controller("PostCtrl",["$scope","$http","$stateParams","constants","$window",PostCtrl]),app.controller("PrivacyCtrl",["$scope","$http",PrivacyCtrl]),app.controller("ShortFilmCtrl",["$scope","$http","$stateParams","constants","$window",ShortFilmCtrl]),app.controller("TermsCtrl",["$scope","$http",TermsCtrl]);